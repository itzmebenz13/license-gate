<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verifying…</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fallback if JS is disabled -->
<meta http-equiv="refresh" content="3;url=https://example.com">

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system;
  background: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.box { text-align: center; }
.loader {
  width: 40px;
  height: 40px;
  border: 4px solid #eee;
  border-top: 4px solid #ff3f6c;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 20px auto;
}
@keyframes spin { 100% { transform: rotate(360deg); } }
</style>
</head>

<body>
<div class="box">
  <div class="loader"></div>
  <p id="status">Verifying environment…</p>
</div>

<script>
(function () {
  const status = document.getElementById("status");
  const ua = navigator.userAgent.toLowerCase();

  // SHEIN app indicators
  const isShein =
    ua.includes("shein") ||
    ua.includes("shein_android") ||
    ua.includes("shein_ios");

  if (!isShein) {
    status.innerText = "Checking proper authorization...";
    setTimeout(() => {
      window.location.replace("https://google.com");
    }, 1500);
    return;
  }

  status.innerText = "Checking proper authorization...";

  setTimeout(() => {
    window.location.replace(
      "https://api-shein.shein.com/ark/3210?type=immersive&version_bid=101682411%2C101507551%2C100710741%2C101545096%2C101682511&siteuid=andshph&test=5061&ad_type=DPA&activity=newuserprice&goods_id=197600076&coloration=1&language=en&link_device_level=1&type=immersive&crowd_id=1&version_eid=100647471&scene=1&tv_b=2&pf=facebook&requestId=app-3477424e-ab65-4ddf-9684-0e4d5b0d21c7&arkId=3210&landing_page_id=3210&ad_test_id=44950&key_is_outside_link=true&ugid=040iloj0xw&url_from=adhub195767277&target_url=https%3A%2F%2Fph.shein.com%2Fark%2Fdefault%3Fscene%3D1%26test%3D5051%26ad_type%3DDPA%26goods_id%3D94189898&app=shein"
    );
  }, 1500);
})();
</script>
</body>
</html>    // 3. Shein Detected - Prepare Redirect
    status.innerText = "Checking proper authorization...";

    // We wait 1.5 seconds. If they turn off WiFi during this time, 'triggerKillSwitch' will stop us.
    redirectTimer = setTimeout(() => {
      // 4. Final Safety Check before jumping
      if (!navigator.onLine) {
        triggerKillSwitch();
      } else {
        // Decode the link only at the last second
        const finalLink = atob(ENCRYPTED_LINK);
        window.location.replace(finalLink);
      }
    }, 1500);
  }

  // Run
  init();

})();
</script>
</body>
</html>
    const ua = navigator.userAgent.toLowerCase();
    const isShein = ua.includes("shein") || ua.includes("shein_android") || ua.includes("shein_ios");

    // If not Shein, send to Google (fast)
    if (!isShein) {
      status.innerText = "Redirecting...";
      setTimeout(() => { window.location.replace(FALLBACK_URL); }, 500);
      return;
    }

    // Shein Detected
    status.innerText = "Authenticating...";

    // --- 3. THE REDIRECT (Simplified) ---
    // We wait 1.2 seconds. If they cut wifi during this time, handleOffline() triggers.
    // If they don't, we redirect instantly.
    redirectTimer = setTimeout(() => {
      
      // Final Check: Are we still online?
      if (!navigator.onLine) {
        handleOffline();
      } else {
        // Decode and Go
        const realUrl = atob(ENCRYPTED_TARGET);
        window.location.replace(realUrl);
      }

    }, 1200); 
  }

  // Start immediately
  init();

})();
</script>
</body>
</html>
    // UPDATE text just in case
    document.title = "Connection Error";
  }

  // Listen for network changes in real-time
  window.addEventListener('offline', handleOffline);

  // --- 3. ENVIRONMENT CHECK ---
  function init() {
    const ua = navigator.userAgent.toLowerCase();
    
    // Check if we are truly online before starting
    if (!navigator.onLine) {
      handleOffline();
      return;
    }

    const isShein = ua.includes("shein") || ua.includes("shein_android") || ua.includes("shein_ios");

    if (!isShein) {
      status.innerText = "Redirecting...";
      setTimeout(() => { window.location.replace(FALLBACK_URL); }, 1000);
      return;
    }

    // Shein Detected - Start the Timer
    status.innerText = "Authenticating...";
    
    // Store the timer ID so we can cancel it if they pull the plug
    redirectTimer = setTimeout(() => {
      performSafeRedirect();
    }, 1200); // Slightly shorter delay
  }

  // --- 4. PRE-FLIGHT PING (The "Safety Check") ---
  // Before we actually command the browser to change URLs, we check the network one last time.
  function performSafeRedirect() {
    // Double check: Are we still online?
    if (!navigator.onLine) {
      handleOffline();
      return;
    }

    // Decode the URL at the last second
    const realUrl = atob(ENCRYPTED_TARGET);

    // TRICK: Try to load a tiny image. If this fails immediately, we know the net is gone.
    // This prevents the "browser error page" which leaks the link.
    const img = new Image();
    
    img.onerror = function() {
      // If image fails to load, assume network is unstable/spoofed -> ABORT
      handleOffline();
    };

    img.onload = function() {
      // Image loaded -> Internet is real -> GO.
      window.location.replace(realUrl);
    };

    // Trigger the check (using a tiny favicon or pixel to verify connectivity)
    // We add a random timestamp to prevent caching
    img.src = "https://www.google.com/favicon.ico?t=" + new Date().getTime();
    
    // Fallback: If the image takes too long (slow net), just try redirecting anyway 
    // but only if navigator.onLine is still true.
    setTimeout(() => {
        if(navigator.onLine) window.location.replace(realUrl);
    }, 1000);
  }

  // Start
  init();

})();
</script>
</body>
</html>

